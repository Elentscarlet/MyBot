# 默认技能：根基加点赋予============================================
# type，target，stop_propagation 字段目前无效
- id: basic_attack
  name: 普攻
  type: active
  cost: { mp: 0 }
  cd: 0
  stop_propagation: false
  get_by_gacha: false
  target: enemy_single
  description: "【基础技能】普通攻击：根据力量造成伤害，倍率1.0，可以暴击"
  triggers:
    - event_type: "attack"
      is_attacker: true
      priority: 0
  effects:
    - op: "damage"
      formula: "max(1, source.ATK)"
      can_crit: true
      crit_multiplier: 1.5
      can_dodge: true

- id: active_power
  name: 力量打击
  type: active
  cost: { mp: 0 }
  cd: 3
  stop_propagation: false
  get_by_gacha: false
  target: enemy_single
  description: "【基础技能】【力量>=8获取】力量打击：根据力量造成伤害，技能倍率2.0，可以暴击"
  triggers:
    - event_type: "attack"
      is_attacker: true
      priority: 2
  effects:
    - op: "damage"
      formula: "source.ATK * 2.0"
      damage_type: "physical"
      can_crit: true
      crit_multiplier: 1.5
      can_dodge: false

- id: attack_bonus
  name: 连击
  type: active
  cost: { mp: 0 }
  cd: 2
  stop_propagation: false
  get_by_gacha: false
  description: "【基础技能】【敏捷>=8获取】连击：攻击时有概率攻击2次，技能倍率1.1，可以暴击"
  triggers:
    - event_type: "attack"
      is_attacker: true
      priority: 2
  effects:
    - op: "damage"
      formula: "source.ATK * 1.1"
      damage_type: "physical"
      can_crit: true
      crit_multiplier: 2.0
      can_dodge: true
    - op: "damage"
      formula: "source.ATK * 1.1"
      damage_type: "physical"
      can_crit: true
      crit_multiplier: 2.0
      can_dodge: true

# 被动技能
- id: passive_thorns
  name: 铜墙铁壁
  type: passive
  cost: { mp: 0 }
  cd: 1
  stop_propagation: true
  get_by_gacha: false
  description: "【基础技能】【防御>=8获取】铜墙铁壁：受到伤害时，根据防御力减免伤害"
  triggers:
    - event_type: "damage_calc"
      is_attacker: false
      conditions:
        - expr: "damage > 0 and damage_type == 'physical' and is_dodged == False"

  effects:
    - op: "damage_reduction"
      formula: "damage * (source.DEF / (source.DEF + 50))"

- id: life_steal
  name: 吸血
  type: active
  cost: { mp: 0 }
  cd: 0
  stop_propagation: true
  get_by_gacha: false
  description: "【基础技能】【体力>=8获取】吸血：造成伤害时，根据造成伤害值吸血，基础10%"
  triggers:
    - event_type: "after_take_damage"
      is_attacker: true
      conditions:
        - expr: "damage >0 and damage_type == 'physical' and is_dodged == False"
      priority: 2

  effects:
    - op: "leech"
      formula: "damage * (0.1 + source.MAX_HP * 0.001)"

- id: break_armor
  name: 破甲
  type: passive
  cost: { mp: 0 }
  cd: 0
  stop_propagation: true
  get_by_gacha: false
  description: "【基础技能】【暴击>=8获取】破甲：暴击时降低敌方护甲5点，持续5回合，可以叠加"
  triggers:
    - event_type: "damage_calc"
      is_attacker: true
      conditions:
        - expr: "damage >0 and damage_type == 'physical' and is_crit == True and is_dodged == False"
      priority: 2

  effects:
    - op: "apply_buff"
      buff_id: "armor_break"
      stacks_formula: "1"
      is_self_target: false

# 装备技能，随机抽取：============================================

- id: thorns
  name: 荆棘
  type: passive
  cost: { mp: 0 }
  cd: 0
  level: 1
  get_by_gacha: true
  description: "【武器技能】【荆棘】:受到伤害时反弹伤害"
  stop_propagation: false
  triggers:
    - event_type: "after_take_damage"
      is_attacker: false
      conditions:
        - expr: "damage > 0 and damage_type == 'physical' and op_type == 'damage'"

  effects:
    - op: "reflect_damage"
      formula: "max(1, source.DEF* (0.4 + skill.level * 0.5))"
      damage_type: "physical"
      can_dodge: false

- id: fire_enchant
  name: 火焰附魔
  type: passive
  cost: { mp: 0 }
  cd: 0
  level: 1
  get_by_gacha: true
  description: "【武器技能】【火焰附魔】:攻击时附加火焰伤害，随技能等级提升"
  stop_propagation: true
  triggers:
    - event_type: "damage_calc"
      is_attacker: true
      conditions:
        - expr: "damage > 0 and op_type == 'damage' and is_dodged == False "
  effects:
    - op: "add_damage"
      formula: "skill.level*8"
      damage_type: "fire"

- id: resurrect
  name: 起死回生
  type: passive
  cost: { mp: 0 }
  cd: 999
  level: 1
  get_by_gacha: true
  description: "【武器技能】【起死回生】:一次对战仅限一次，受到致死伤害时，免疫这次死亡，恢复一定血量"
  stop_propagation: true
  triggers:
    - event_type: "after_take_damage"
      is_attacker: false
      conditions:
        - expr: "damage > 0 and target.is_alive == False"
  effects:
    - op: "heal"
      formula: "source.MAX_HP/10 * skill.level"
      can_apply_on_death: true

- id: thunder_strike
  name: 雷霆一击
  type: passive
  cost: { mp: 0 }
  cd: 0
  level: 1
  get_by_gacha: true
  description: "【武器技能】【雷霆一击】:攻击时有几率触发额外雷电伤害,对敌方造成百分比生命伤害"
  stop_propagation: true
  triggers:
    - event_type: "damage_calc"
      is_attacker: true
      conditions:
        - expr: "damage > 0 and op_type == 'damage' and is_dodged == False "
        - expr: "random() < 0.10 + skill.level * 0.05"  # 10%基础几率，每级提升5%
  effects:
    - op: "add_damage"
      formula: "min(50 * skill.level , target.MAX_HP * skill.level/10)"
      damage_type: "lightning"

- id: full_power
  name: 战意高昂
  type: passive
  cost: { mp: 0 }
  cd: 0
  level: 1
  get_by_gacha: true
  description: "【武器技能】【战意高昂】:回合开始时，如果为满血，获得全属性加成"
  stop_propagation: true
  triggers:
    - event_type: "round_start"
      is_attacker: true
      conditions:
        - expr: "source.HP == source.MAX_HP"
  effects:
    - op: "apply_buff"
      buff_id: "full_power"
      stacks_formula: "5*skill.level"
      is_self_target: true

- id: endure
  name: 忍耐
  type: active
  cost: {mp: 0}
  cd: 5
  level: 1
  get_by_gacha: true
  description: "【武器技能】【忍耐】:本回合不攻击，在下回合开始时，造成已损失生命值1.2倍伤害(每级+0.2)，并回复一半的血量"
  stop_propagation: true
  triggers:
    - event_type: "attack"
      is_attacker: true
      priority: 3
  effects:
    - op: "apply_buff"
      buff_id: "endure"
      stacks_formula: "skill.level"
      is_self_target: true

- id: bloom
  name: 生生不息
  type: passive
  cost: {mp: 0}
  cd: 0
  level: 1
  get_by_gacha: true
  description: "【武器技能】【生生不息】:自己的回合开始时恢复(10+2%)*等级的生命"
  stop_propagation: true
  triggers:
    - event_type: "round_start"
      is_attacker: true
      priority: 3
  effects:
    - op: "heal"
      formula: "10*skill.level + source.MAX_HP/50 * skill.level"
      can_apply_on_death: false
      is_self_target: true

- id: entrapment
  name: 蛛网束缚
  type: active
  cost: {mp: 0}
  cd: 5
  level: 1
  get_by_gacha: true
  description: "【武器技能】【蛛网束缚】:造成少量持续伤害，并降低目标(3*等级)点敏捷"
  stop_propagation: true
  triggers:
    - event_type: "attack"
      is_attacker: true
      priority: 3
  effects:
    - op: "damage"
      formula: "source.ATK * 0.4"
      damage_type: "physical"
      can_crit: false
      can_dodge: false
    - op: "apply_buff"
      buff_id: "slow"
      stacks_formula: "skill.level*3"
      is_self_target: false
    - op: "apply_buff"
      buff_id: "poison"
      stacks_formula: "skill.level*3"
      is_self_target: false


